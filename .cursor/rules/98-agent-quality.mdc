---
description: Raise agent/auto mode quality via process and evidence
alwaysApply: true
---

# Agent / Auto Mode Quality

Complements `00-core.mdc` and `02-task-completion.mdc`. When running autonomously in Agent or Auto mode, follow a strict process so analysis, decisions, and outputs stay reliable even when a faster/lighter model is used.

Follow the writing style rules from `00-core.mdc`: no em dashes, no parentheses in prose, write like a human.

## Response Template (Use This Structure)

Follow this order so outputs are predictable and complete:

1. **Goal.** One sentence: what must be true when done.
2. **Read/Verify.** What you will read or run: files, types, commands. **Include: search codebase** via grep/glob/semantic and **PRs/branches** for an existing solution before implementing. Then do it.
3. **Plan.** 1 to 3 bullets: what you will do. If multi-step, name the steps and do one at a time. When producing a full plan like in Plan mode, include a **Test Scenarios** section per `97-plan-test-scenarios.mdc` covering traceability, happy path, edge cases, errors, and security/integration when relevant.
4. **Do.** Make the changes. Prefer minimal edits as described below.
5. **Verify.** Run the relevant commands and **paste the output**, last 10 to 20 lines is enough. Do not say "tests pass" without showing it. When the task was planned with test scenarios per `97-plan-test-scenarios.mdc`, confirm that each planned scenario is covered by tests and that those tests pass.

Short, scannable lists beat long paragraphs. Use bullets and tables when summarizing.

## Before Acting

1. **State the goal** in one sentence. What must be true when done.
2. **List what must be read or verified**: files, APIs, types, env. **Include a search for existing solution** in the codebase and PRs/branches. Then **perform each** read, grep, or run before proposing code.
3. **Propose the approach** in 1 to 3 bullets. If the task is multi-step, break it into steps and work one at a time.

Do not implement until the above is done. Prefer verification over speed.

## While Implementing

- **One logical change per turn** when possible. Cap edits at 3 to 5 files per task unless the task explicitly requires more.
- **Read before edit.** Open the real file and reference line numbers or symbols. Do not assume signatures or structure.
- **Minimal edit.** Prefer the smallest change that fixes the issue. Use targeted search_replace when possible. Avoid rewriting whole files unless necessary.
- **After each significant step**, like adding a file, changing an API contract, or changing env/config, run the relevant check like `npm run lint`, `npm run test`, or the project's build and **show the output**. Do not claim success without evidence.
- **In Agent/Auto, never say "I would run X" or "you can run X".** Run the command and paste the output. No exceptions.
- **Before declaring any task done**, run the mandatory commands from `02-task-completion.mdc` for test, lint, and build. **Paste their output** in the delivery summary.

## Evidence Required

- **Never claim** "tests pass", "build succeeds", or "it works" without showing command output or a concrete file excerpt.
- When suggesting a fix: include the minimal code change, the exact command to validate it, and the expected outcome including edge cases if relevant.
- If something is unclear like a missing file or ambiguous requirement, say so and ask for details via @file instead of guessing.

## When in Doubt

- **Stop and verify.** Read the code, run the command, then answer.
- **Smaller steps.** Split the task, do one step, show evidence, then continue.
- **Explicit trade-offs.** If there are multiple valid approaches, state them briefly and say which one you chose and why.
- **One question at a time.** If several things are unclear, ask the single most blocking question first. Continue after the answer instead of listing many questions at once.
- **Stop after 3 failed attempts.** If the same fix or approach fails three times, stop. Summarize what was tried, what failed, and what might be wrong. Ask the user or suggest a different approach. Do not keep guessing.

## Output Style (Helps Simpler Models Stay On Track)

- Use **short sentences** and **bullets** for summaries and checklists.
- Prefer **concrete** over abstract: file paths, command names, line references.
- When summarizing changes: list **Files**, then **What changed**, then **How to verify** with the command and expected result.
- Avoid long prose when a list or table would do.
- Follow the writing style from `00-core.mdc`: no em dashes, no parentheses in prose, natural human tone.

## Product Tip

In Cursor, **Settings > Models** lets you choose the default model for Chat, Composer, and Agent. If Auto uses a lighter model and quality drops, consider setting the Agent or Composer default to a stronger model like Claude Opus for complex or multi-file tasks. Use a faster model only for small, clear edits.
