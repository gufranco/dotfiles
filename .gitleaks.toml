# Gitleaks configuration for dotfiles repository
title = "Gitleaks Configuration for Dotfiles"

# Files to ignore
[allowlist]
description = "Allowlist for dotfiles repository"
paths = [
  # Ignore plugin directories (third-party code)
  '''vim/plugged/.*''',
  '''tmux/plugins/.*''',

  # Ignore encrypted files (all protected with strong passphrases)
  '''\.gpg$''',
  '''\.asc$''',

  # Ignore public keys
  '''\.pub$''',
  '''\.public\.pgp$''',

  # Ignore encrypted GPG keys (protected with 128-char passphrases)
  '''gnupg/keys/.*\.pgp$''',
  '''gnupg/private-keys-v1.d/.*''',

  # Ignore SSH keys (password-protected)
  '''ssh/id_.*''',
  '''!ssh/.*\.pub$''',  # But allow public keys

  # Ignore encrypted passwords
  '''mutt/accounts/.*/password\.gpg$''',
  '''nodejs/tokens/.*\.gpg$''',

  # Ignore example/template files
  '''\.example$''',
  '''\.sample$''',
  '''\.template$''',

  # Ignore this config file
  '''\.gitleaks\.toml$''',
]

regexes = [
  # Allow placeholder tokens (common in dotfiles)
  '''(NPM_TOKEN|GITHUB_TOKEN)=\$\{.*\}''',
  '''\$\{NPM_TOKEN\}''',

  # Allow example/placeholder values
  '''(password|token|key).*=.*"(example|placeholder|your_.*|PLACEHOLDER)"''',
]

# Stop words to reduce false positives
stopwords = [
  "example",
  "sample",
  "placeholder",
  "your_",
  "PLACEHOLDER",
  "dummy",
  "test",
  "fake",
]

# Additional rules to skip
[[rules]]
description = "Skip GPG key IDs (not secrets)"
id = "gpg-key-id"
regex = '''(0x)?[A-F0-9]{16,40}'''
path = '''(gnupg/|git/\.gitconfig)'''

[[rules]]
description = "Skip SSH key fingerprints"
id = "ssh-fingerprint"
regex = '''[0-9a-f]{2}(:[0-9a-f]{2}){15,31}'''
path = '''ssh/'''

[[rules]]
description = "Skip npm registry URLs"
id = "npm-registry"
regex = '''registry\.npmjs\.org'''
path = '''nodejs/'''

